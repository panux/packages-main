packages:
  efibootmgr:
    dependencies:
    - efivar
version: 14
sources:
- https://github.com/rhboot/efibootmgr/archive/{{.Version}}.tar.gz
builddependencies:
- popt-dev
- linux-headers
- zlib-dev
- gettext-dev
- binutils
- efivar
- efivar-headers
builder: panux
oneshell: true
script:
- |
  tar -xf src/{{.Version}}.tar.gz
  mv efibootmgr-{{.Version}} efibootmgr
  sed -i -e s/-Werror// Make.defaults
  $(MAKE) -C efibootmgr EFIDIR=/boot/efi LDLIBS="-lefivar -lefiboot -lintl -lpopt"
  $(MAKE) -C efibootmgr libdir="/usr/lib" EFIDIR=/boot/efi DESTDIR=$(shell pwd)/out/efibootmgr install
  mv out/efibootmgr/usr/sbin out/efibootmgr/usr/bin
