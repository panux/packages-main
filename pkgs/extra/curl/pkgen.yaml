packages:
  curl:
    dependencies:
    - libcurl
    - ca-certificates
  libcurl:
    dependencies:
    - libressl
    - zlib
  curl-man:
  curl-headers:
version: 7.54.1
builddependencies:
- gcc
- libc-dev
- ncurses-dev
- zlib-dev
- libressl-dev
sources:
- https://curl.haxx.se/download/curl-{{.Version}}.tar.gz
script:
- |
  {{extract "curl" "gz"}}
  (cd curl && ./configure --build={{confarch}}-pc-linux-gnu --with-ssl --disable-static)
  $(MAKE) -C curl
  $(MAKE) -C curl DESTDIR=$(shell pwd)/out/curl install
  mkdir -p out/libcurl/usr/local
  mv out/curl/usr/local/lib out/libcurl/usr/local
  mkdir -p out/curl-man/usr/local
  mv out/curl/usr/local/share out/curl-man/usr/local
  mkdir -p out/curl-headers/usr/local
  mv out/curl/usr/local/include out/curl-headers/usr/local
  mv out/curl/usr/local/bin out/curl/usr
  rm -r out/curl/usr/local
