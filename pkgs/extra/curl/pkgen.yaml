packages:
  curl:
    dependencies:
    - libcurl
    - ca-certificates
  libcurl:
    dependencies:
    - libressl
    - zlib
  curl-man:
  curl-headers:
version: 7.54.1
builddependencies:
- ncurses-dev
- zlib-dev
- libressl-dev
sources:
- https://curl.haxx.se/download/curl-{{.Version}}.tar.gz
builder: panux
script:
- |
  {{extract "curl" "gz"}}
  {{configure "curl" "--with-ssl --disable-static CFLAGS=-fPIC"}}
  $(MAKE) -C curl
  $(MAKE) -C curl DESTDIR=$(shell pwd)/out/curl install
  mkdir -p out/libcurl/usr/local
  mv out/curl/usr/local/lib out/libcurl/usr/local
  mkdir -p out/curl-man/usr/local
  mv out/curl/usr/local/share out/curl-man/usr/local
  mkdir -p out/curl-headers/usr/local
  mv out/curl/usr/local/include out/curl-headers/usr/local
  mv out/curl/usr/local/bin out/curl/usr
  rm -r out/curl/usr/local
