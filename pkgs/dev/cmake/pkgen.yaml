packages:
  cmake:
    dependencies:
    - libexpat
    - libarchive
    - libcurl
    - libgcc
    - libstdcpp
    - libuv
    - musl
    - ncurses
    - librhash
    - zlib
  cmake-doc:
version: 3.9.5
builddependencies:
- gpp
- libstdcpp-dev
- ncurses-dev
- curl-headers
- libcurl
- expat-dev
- zlib-dev
- bzip2-dev
- libarchive-dev
- libuv-dev
- xz-dev
- rhash-dev
- util-linux
sources:
- https://cmake.org/files/v3.9/cmake-{{.Version}}.tar.gz
builder: panux
script:
- |
  {{extract "cmake" "gz"}}
  {{configure "cmake" "--datadir=/usr/share/cmake --docdir=/usr/share/doc/cmake --system-libs --no-system-jsoncpp"}}
  $(MAKE) -C cmake
  $(MAKE) -C cmake DESTDIR=$(shell pwd)/out/cmake install
  {{pkmv "usr/share/doc" "cmake" "cmake-doc"}}
  (cd out/cmake/usr/share/cmake/Help/generator && rename ' ' '_' * && rename ' ' '_' * && rename ' ' '_' * && rename ' ' '_' *)
