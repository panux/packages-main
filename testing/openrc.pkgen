packages:
  openrc:
    dependencies:
    - ncurses
  openrc-headers:
    depencendies:
    - ncurses-headers
    - libc-headers
    - linux-headers
  openrc-man:
  openrc-doc:
version: 0.28
builddependencies:
- gcc
- libc-dev
- ncurses-dev
- linux-headers
sources:
- https://gitweb.gentoo.org/proj/openrc.git/snapshot/openrc-{{.Version}}.tar.gz
- https://git.alpinelinux.org/cgit/aports/plain/main/openrc/0003-sysctl-add-compatibility-for-busybox-sysctl.patch
script:
- tar -xf src/openrc-{{.Version}}.tar.gz
- mv openrc-{{.Version}} openrc
- (cd openrc && patch ../src/0003-sysctl-add-compatibility-for-busybox-sysctl.patch)
- $(MAKE) -C openrc MKSTATICLIBS=no MKPKGCONFIG=no LIBEXECDIR=/usr/libexec/openrc
- $(MAKE) -C openrc MKSTATICLIBS=no MKPKGCONFIG=no LIBEXECDIR=/usr/libexec/openrc DESTDIR=$(shell pwd)/out/openrc install
- mv out/openrc/lib out/openrc/usr/lib
- mv out/openrc/sbin out/openrc/usr/bin
- mv out/openrc/bin/* out/openrc/usr/bin
- rm -r out/openrc/bin
- mkdir -p out/openrc-man/usr/share
- mv out/openrc/usr/share/man out/openrc-man/usr/share/man
- mkdir out/openrc-doc/usr
- mv out/openrc/usr/share out/openrc-doc/usr/share
- mkdir out/openrc-headers/usr
- mv out/openrc/usr/include out/openrc-headers/usr/include
