packages:
  efibootmgr:
    dependencies:
    - efivar
version: 14
sources:
- git://github.com/rhboot/efibootmgr?target={{.Version}}
- https://repo.projectpanux.com/beta/x86_64/pkgs/efivar-include.tar.gz
- https://repo.projectpanux.com/beta/x86_64/pkgs/efivar.tar.gz
- https://repo.projectpanux.com/beta/x86_64/pkgs/libefiboot.tar.gz
- https://repo.projectpanux.com/beta/x86_64/pkgs/libefivar.tar.gz
builddependencies:
- popt-dev
- linux-headers
- zlib-dev
- gettext-dev
- gettext-static
- pkgconfig
- binutils
oneshell: true
script:
- |
  for i in src/*.tar.gz; do tar -xf $$i -C /; echo $$i; done
  mv src/efibootmgr efibootmgr
  sed -i -e s/-Werror// Make.defaults
  $(MAKE) -C efibootmgr EFIDIR=/boot/efi LDLIBS="-lefivar -lefiboot -lintl -lpopt"
  $(MAKE) -C efibootmgr libdir="/usr/lib" EFIDIR=/boot/efi DESTDIR=$(shell pwd)/out/efibootmgr install
  mv out/efibootmgr/usr/sbin out/efibootmgr/usr/bin
