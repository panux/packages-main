packages:
  eudev:
    dependencies:
    - eudev-libs
  eudev-dev:
    dependencies:
    - eudev
  eudev-doc:
  eudev-libs:
version: 3.2.2
builddependencies:
- gperf
- glib-dev
- linux-headers
- kmod-dev
- gobject-introspection-dev
- util-linux-dev
sources:
- https://dev.gentoo.org/~blueness/eudev/eudev-{{.Version}}.tar.gz
script:
- tar -xf src/eudev-{{.Version}}.tar.gz
- mv eudev-{{.Version}} eudev
- (cd eudev && ./configure --build={{.Arch}}-pc-linux-gnu --sysconfdir=/etc --with-rootprefix= --with-rootrundir=/run --with-rootlibexecdir=/lib/udev --libdir=/usr/lib --enable-split-usr --enable-manpages --disable-hwdb --disable-kmod --exec-prefix=/)
- $(MAKE) -C eudev
- $(MAKE) -C eudev DESTDIR=$(shell pwd)/out/eudev install
- mkdir -p out/eudev-dev/usr/lib
- mv out/eudev/usr/include out/eudev-dev/usr
- mv out/eudev/usr/lib/pkgconfig out/eudev/usr/lib/libudev.so out/eudev/usr/lib/libudev.a out/eudev-dev/usr/lib
- mkdir -p out/eudev-doc/usr
- mv out/eudev/usr/share out/eudev-doc/usr
- cp out/eudev/usr/lib/libudev.so.1 out/eudev/lib
- cp out/eudev/usr/lib/libudev.so.1.6.3 out/eudev/lib
- mkdir -p out/eudev-libs/lib
- mv out/eudev/lib/libudev.so.1 out/eudev/lib/libudev.so.1.6.3 out/eudev-libs/lib
