packages:
  pcre:
    dependencies:
    - musl
    - ncurses
  pcre-doc:
  pcre-man:
  pcre-headers:
version: 8.41
sources:
- https://astuteinternet.dl.sourceforge.net/project/pcre/pcre/{{.Version}}/pcre-{{.Version}}.tar.bz2
builddependencies:
- g++
- zlib-dev
- bzip2-dev
- readline-dev
script:
- tar -xf src/pcre-{{.Version}}.tar.bz2
- mv pcre-{{.Version}} pcre
- (cd pcre && ./configure --prefix=/usr --docdir=/usr/share/doc/pcre-8.41 --enable-unicode-properties --enable-pcre16 --enable-pcre32 --enable-pcregrep-libz --enable-pcregrep-libbz2 --enable-pcretest-libreadline --disable-static)
- $(MAKE) -C pcre
- $(MAKE) -C pcre check
- $(MAKE) -C pcre install DESTDIR=$(shell pwd)/out/pcre
- rm -r out/pcre/usr/lib/pkgconfig
- mkdir -p out/pcre-doc/usr/share
- mv out/pcre/usr/share/doc out/pcre-doc/usr/share/doc
- mkdir -p out/pcre-man/usr/share
- mv out/pcre/usr/share/man out/pcre-doc/usr/share/man
- mkdir -p out/pcre-headers/usr
- mv out/pcre/usr/include out/pcre-headers/usr/include
